前面的文章我们已经了解了什么是JavaScript中的对象，以及V8内部是怎么存储对象的，本节我们继续深入学习对象，一起来聊聊V8是如何实现JavaScript中对象继承的

简单的理解，继承就是一个对象可以访问另一个对象中的属性和方法，比如我有一个对象b，该对象继承了A对象，那么B对象便可以直接访问A对象中的属性和方法，你可以参考下图

![img](https://liangx-gallery.oss-cn-beijing.aliyuncs.com/202303020925722.jpg)

观察上图，因为B继承了A，那么B可以直接使用A中的color属性，就像这个属性是B自带的一样

不同的语言实现继承的方式是不同的，其中最经典的两种方式是基于类的设计和基于原型继承的设计

C++，Java，C#这些语言都是基于经典的类继承的设计模式，这种模式最大的特点就是提供了非常复杂的规则，并提供了非常多的关键字，诸如：class friend。private，interface等。通过组合使用这些关键字，就可以实现继承

使用基于类的继承时，如果业务复杂，那么你需要创建大量的对象，然后需要维护非常复杂的继承关系，这会导致代码过度复杂和臃肿，另外引入了这么多关键字也给设计带来了更大的复杂度。

而 JavaScript的继承方式和其他面向对象的继承方式有很大差别，JavaScript本身不提供一个class实现，虽然标准委员会在ES2015/ES6中引入了class关键字，但那只是语法糖，JavaScript中继承依然和基于类的继承没有任何关系，所以当你看到JavaScript出现了class关键字，不要认为JavaScript也是面向对象的语言了

JavaScript仅仅在对象中引入了一个原型的属性，就实现了语言的继承机制，基于原型的继承省去了很多基于类继承的繁文缛节，简洁而优美

### 原型继承是如何实现的

那么基于原型继承是如何实现的呢？

![img](https://liangx-gallery.oss-cn-beijing.aliyuncs.com/202303020934603.jpg)



有一个对象 C，它包含了一个属性“type”，那么对象 C 是可以直接访问它自己的属性 type 的，这点毫无疑问。

怎样让 C 对象像访问自己的属性一样，访问 B 对象呢？

上节我们从 V8 的内存快照看到，JavaScript 的每个对象都包含了一个隐藏属性 __proto__ ，我们就把该隐藏属性 __proto__ 称之为该对象的原型 (prototype)，__proto__ 指向了内存中的另外一个对象，我们就把 __proto__ 指向的对象称为该对象的原型对象，那么该对象就可以直接访问其原型对象的方法或者属性。

比如我让 C 对象的原型指向 B 对象，那么便可以利用 C 对象来直接访问 B 对象中的属性或者方法了，最终的效果如下图所示：

![img](https://liangx-gallery.oss-cn-beijing.aliyuncs.com/202303020946556.jpg)

观察上图，当 C 对象将它的 __proto__ 属性指向了 B 对象后，那么通过对象 C 来访问对象 B 中的 name 属性时，V8 会先从对象 C 中查找，但是并没有查找到，接下来 V8 继续在其原型对象 B 中查找，因为对象 B 中包含了 name 属性，那么 V8 就直接返回对象 B 中的 name 属性值，虽然 C 和 B 是两个不同的对象，但是使用的时候，B 的属性看上去就像是 C 的属性一样。

同样的方式，B 也是一个对象，它也有自己的 __proto__ 属性，比如它的属性指向了内存中另外一块对象 A，如下图所示：

![img](https://liangx-gallery.oss-cn-beijing.aliyuncs.com/202303021015837.jpg)

从图中可以看到，对象 A 有个属性是 color，那么通过 C.color 访问 color 属性时，V8 会先在 C 对象内部查找，但是没有查找到，接着继续在 C 对象的原型对象 B 中查找，但是依然没有查找到，那么继续去对象 B 的原型对象 A 中查找，因为 color 在对象 A 中，那么 V8 就返回该属性值。

我们看到使用 C.name 和 C.color 时，给人的感觉属性 name 和 color 都是对象 C 本身的属性，但实际上这些属性都是位于原型对象上，我们把这个查找属性的路径称为原型链，它像一个链条一样，将几个原型链接了起来。

这里注意一点不要把原型链和作用域搞混了，作用域链是沿着函数的作用域一级一级来查找变量的，而原型链是沿着对象的原型一级一级来查找属性的，虽然它们的实现方式是类似的，但是它们的用途是不同的，